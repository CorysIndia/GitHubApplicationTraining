<ResourceDictionary xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
                    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml">

   
    <Style x:Key="RSI_ESDLevel_ArrowStyle" TargetType="{x:Type RSI_ESDLevel}">
        <Setter Property="Width" Value="125" />
        <Setter Property="Height" Value="14.25" />
        <Setter Property="FODFaceplateName" Value=""/>
        <Setter Property="StandardFaceplateName" Value=""/>
        <Setter Property="FailureFaceplateName" Value=""/>
        <Setter Property="MaintenanceFaceplateName" Value=""/>
        <Setter Property="Template">
            <Setter.Value>
                <ControlTemplate TargetType="{x:Type RSI_ESDLevel}">
                    <RSILine x:Name="line"
                             Stroke="{Value State, Converter={IfThenElse Red:Blue}}" 
                             VerticalAlignment="Center" 
                             ArrowStartStyle="Normal" 
                             StrokeThickness="4" 
                             ArrowHeadWidth="13" 
                             ArrowHeadLength="{Binding ArrowHeadWidth, ElementName=line}"/>
                </ControlTemplate>
            </Setter.Value>
        </Setter>
    </Style>
    
    <Style x:Key="RSI_AN_ArrowStyle" TargetType="{x:Type RSI_AN}">
        <Setter Property="Height" Value="20"/>
        <Setter Property="Width" Value="100"/>
        <Setter Property="FODFaceplateName" Value=""/>
        <Setter Property="FailureFaceplateName" Value=""/>
        <Setter Property="StandardFaceplateName" Value=""/>
        <Setter Property="MaintenanceFaceplateName" Value=""/>
        <Setter Property="Template">
            <Setter.Value>
                <ControlTemplate TargetType="{x:Type RSI_AN}">
                    <RSILine x:Name="line"
                             Stroke="Blue"
                             VerticalAlignment="Center" 
                             ArrowStartStyle="Normal" 
                             StrokeThickness="{TemplateBinding IsAlarmFirstCause, Converter={IfThenElse 8:3}}" 
                             ArrowHeadWidth="{TemplateBinding IsAlarmFirstCause, Converter={IfThenElse 18:13}}"
                             ArrowHeadLength="{Binding ArrowHeadWidth, ElementName=line}">
                        <RSILine.Animations>
                            <Animation Condition="$ESDINPUT.INHIB = 0 AND ($TAGNAME.STATEAlarms.Alarms[ALARM].IsStatusAcknowledged OR $TAGNAME.STATEAlarms.Alarms[ALARM].IsStatusActive)">
                                <ChangePropertyValue PropertyName="Stroke" Value="Red"/>
                            </Animation>
                        </RSILine.Animations>
                    </RSILine>
                </ControlTemplate>
            </Setter.Value>
        </Setter>
    </Style>

    <Style x:Key="RSI_Static_ValveClapetStyle" TargetType="{x:Type RSI_StaticControl}">
        <Setter Property="Width" Value="10" />
        <Setter Property="Height" Value="15" />
        <Setter Property="Background" Value="Black" />
        <Setter Property="BorderBrush" Value="Black" />
        <Setter Property="BorderThickness" Value="1" />
        <Setter Property="Template">
            <Setter.Value>
                <ControlTemplate TargetType="{x:Type RSI_StaticControl}">
                    <Path
                        Data="M0,0 1,1 1,0.75 1,1.25 1,1 0,2z"
                        Fill="{TemplateBinding Background}"
                        Stretch="Fill"
                        Stroke="{TemplateBinding BorderBrush}"
                        StrokeThickness="{TemplateBinding BorderThickness}" />
                </ControlTemplate>
            </Setter.Value>
        </Setter>
    </Style>

    <Style x:Key="RSI_Static_ValveStyle" TargetType="{x:Type RSI_StaticControl}">
        <Setter Property="Width" Value="15" />
        <Setter Property="Height" Value="25" />
        <Setter Property="Background" Value="Black" />
        <Setter Property="BorderBrush" Value="Black" />
        <Setter Property="BorderThickness" Value="1" />
        <Setter Property="Template">
            <Setter.Value>
                <ControlTemplate TargetType="{x:Type RSI_StaticControl}">
                    <Path
                        Data="M0,0 1,0 0,2 1,2z"
                        Fill="{TemplateBinding Background}"
                        Stretch="Fill"
                        Stroke="{TemplateBinding BorderBrush}"
                        StrokeThickness="{TemplateBinding BorderThickness}" />
                </ControlTemplate>
            </Setter.Value>
        </Setter>
    </Style>

    <Style x:Key="RSI_HeatExchanger_HorizontalStyle" TargetType="{x:Type RSI_HeatExchanger}">
        <Setter Property="Width" Value="120"/>
        <Setter Property="Height" Value="35"/>
        <Setter Property="Template">
            <Setter.Value>
                <ControlTemplate TargetType="{x:Type RSI_HeatExchanger}">
                    <Grid>
                        <Grid x:Name="Draw" >
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="1*" />
                                <ColumnDefinition Width="4*" />
                                <ColumnDefinition Width="1*" />
                            </Grid.ColumnDefinitions>

                            <Rectangle Grid.ColumnSpan="3"
                                       RadiusX="15"
                                       RadiusY="40"
                                       Stroke="{TemplateBinding BorderBrush}">
                                <Rectangle.Fill>
                                    <LinearGradientBrush StartPoint="0,0" EndPoint="0,1">
                                        <GradientStop Color="White" Offset="0.5" />
                                        <GradientStop Color="#FF425262" Offset="1" />
                                        <GradientStop Color="#FF425262" />
                                    </LinearGradientBrush>
                                </Rectangle.Fill>
                            </Rectangle>

                            <Path HorizontalAlignment="Right"
                                  Data="M 1,0 L 1,1"
                                  Stretch="Fill"
                                  Stroke="{TemplateBinding BorderBrush}" />
                            <Path Data="M 0,1 L 1,1"
                                  Stretch="Fill"
                                  Stroke="{TemplateBinding BorderBrush}" />


                            <TextBlock x:Name="TagName"
                                       Grid.Column="1"
                                       HorizontalAlignment="Center"
                                       VerticalAlignment="Center"
                                       FontSize="16"
                                       FontWeight="Bold"
                                       Text="{TemplateBinding TagName}" />
                        </Grid>

                        <!--  Flash  -->
                        <Flash Margin="0,-10,-10,0"
                                        HorizontalAlignment="Right"
                                        VerticalAlignment="Top"
                                        Visitor="{Binding RelativeSource={RelativeSource TemplatedParent}}" />
                    </Grid>
                </ControlTemplate>
            </Setter.Value>
        </Setter>
    </Style>

    <Style x:Key="RSI_TONOFF_ArrowStyle" TargetType="{x:Type RSI_TONOFF}">
        <Setter Property="Width" Value="125"/>
        <Setter Property="Height" Value="40"/>
        <Setter Property="Template">
            <Setter.Value>
                <ControlTemplate TargetType="{x:Type RSI_TONOFF}">
                    <Grid >
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="*" />
                            <ColumnDefinition Width="Auto" />
                            <ColumnDefinition Width="*"/>
                        </Grid.ColumnDefinitions>

                        <!--  Left Part  -->
                        <RSI_ESDLevel Style="{StaticResource RSI_ESDLevel_ArrowStyle}" 
                                      Grid.ColumnSpan="3" 
                                      Width="Auto" 
                                      VerticalAlignment="Center"
                                      DataContext="{Binding EsdLevel, RelativeSource={RelativeSource TemplatedParent}}"/>

                        <!--  Central Part  -->
                        <Image Source="/RSI.Emulation.Controls;component/Control/TONOFF/TOnOff.png" Stretch="UniformToFill" Grid.Column="1"/>

                        <!--  Right Part  -->
                        <RSILine x:Name="line"
                                 Grid.Column="2"
                                 Stroke="{Value Output, Converter={IfThenElse Red:Blue}}"
                                 VerticalAlignment="Center" 
                                 ArrowStartStyle="Normal" 
                                 StrokeThickness="4" 
                                 ArrowHeadWidth="13" 
                                 ArrowHeadLength="{Binding ArrowHeadWidth, ElementName=line}"/>
                    </Grid>
                </ControlTemplate>
            </Setter.Value>
        </Setter>
    </Style>
    
    <Style x:Key="RSI_StdSelectorOut_5to8Style" TargetType="{x:Type RSI_StdSelectorOut}">
        <Setter Property="Width" Value="70"/>
        <Setter Property="Height" Value="30"/>
        <Setter Property="Background" Value="Red"/>
        <Setter Property="Template">
            <Setter.Value>
                <ControlTemplate TargetType="{x:Type RSI_StdSelectorOut}">
                    <Grid x:Name="MainGrid" Background="{TemplateBinding Background}">
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="*"/>
                            <ColumnDefinition Width="Auto"/>
                        </Grid.ColumnDefinitions>

                        <Grid x:Name="Draw" RenderTransformOrigin="0.5,0.5">
                            <Grid.Resources>
                                <Style TargetType="{x:Type Line}">
                                    <Setter Property="Stretch" Value="Fill"/>
                                    <Setter Property="Height" Value="5"/>
                                    <Setter Property="Margin" Value="0,-5,0,0"/>
                                    <Setter Property="VerticalAlignment" Value="Top"/>
                                    <Setter Property="Stroke" Value="Black"/>
                                    <Setter Property="StrokeThickness" Value="1"/>
                                    <Setter Property="StrokeEndLineCap" Value="Square"/>
                                    <Setter Property="StrokeStartLineCap" Value="Square"/>
                                    <Setter Property="Y2" Value="1"/>
                                </Style>
                            </Grid.Resources>
                            <Grid.RenderTransform>
                                <ScaleTransform ScaleX="1" ScaleY="-1" />
                            </Grid.RenderTransform>

                            <ContentControl x:Name="Control" Content="{Binding}">
                                <ContentControl.Style>
                                    <Style TargetType="{x:Type ContentControl}">

                                        <!--  NC = 8 : default  -->
                                        <Setter Property="ContentTemplate">
                                            <Setter.Value>
                                                <DataTemplate>
                                                    <Grid x:Name="Draw8">
                                                        <Grid.ColumnDefinitions>
                                                            <ColumnDefinition Width="10*" />
                                                            <ColumnDefinition Width="1.6*" />
                                                            <ColumnDefinition Width="2.4*" />
                                                            <ColumnDefinition Width="3.5*" />
                                                            <ColumnDefinition Width="2.5*" />
                                                            <ColumnDefinition Width="3.2*" />
                                                            <ColumnDefinition Width="4.8*" />
                                                            <ColumnDefinition Width="2*" />
                                                            <ColumnDefinition Width="5*" />

                                                            <ColumnDefinition Width="5*" />
                                                            <ColumnDefinition Width="2*" />
                                                            <ColumnDefinition Width="4.8*" />
                                                            <ColumnDefinition Width="3.2*" />
                                                            <ColumnDefinition Width="2.5*" />
                                                            <ColumnDefinition Width="3.5*" />
                                                            <ColumnDefinition Width="2.4*" />
                                                            <ColumnDefinition Width="1.6*" />
                                                            <ColumnDefinition Width="10*" />
                                                        </Grid.ColumnDefinitions>
                                                        <Line  Y2="1" StrokeEndLineCap="Square" StrokeStartLineCap="Square" 
                                                            x:Name="b_T"
                                                            Grid.Column="1"
                                                            Height="5"
                                                            Margin="0,-5,0,0"
                                                            HorizontalAlignment="Left"
                                                            VerticalAlignment="Top"
                                                            Stretch="Fill"
                                                            Stroke="Black" />
                                                        <Line  Y2="1" StrokeEndLineCap="Square" StrokeStartLineCap="Square" 
                                                            x:Name="f_T"
                                                            Grid.Column="5"
                                                            Height="5"
                                                            Margin="0,-5,0,0"
                                                            HorizontalAlignment="Left"
                                                            VerticalAlignment="Top"
                                                            Stretch="Fill"
                                                            Stroke="Black" />
                                                        <Line  Y2="1" StrokeEndLineCap="Square" StrokeStartLineCap="Square" 
                                                            x:Name="i_T"
                                                            Grid.Column="8"
                                                            Height="5"
                                                            Margin="0,-5,0,0"
                                                            HorizontalAlignment="Left"
                                                            VerticalAlignment="Top"
                                                            Stretch="Fill"
                                                            Stroke="Black" />
                                                        <Line  Y2="1" StrokeEndLineCap="Square" StrokeStartLineCap="Square" 
                                                            x:Name="k_T"
                                                            Grid.Column="9"
                                                            Height="5"
                                                            Margin="0,-5,0,0"
                                                            HorizontalAlignment="Right"
                                                            VerticalAlignment="Top"
                                                            Stretch="Fill"
                                                            Stroke="Black" />
                                                        <Line  Y2="1" StrokeEndLineCap="Square" StrokeStartLineCap="Square" 
                                                            x:Name="n_T"
                                                            Grid.Column="12"
                                                            Height="5"
                                                            Margin="0,-5,0,0"
                                                            HorizontalAlignment="Right"
                                                            VerticalAlignment="Top"
                                                            Stretch="Fill"
                                                            Stroke="Black" />
                                                        <Line  Y2="1" StrokeEndLineCap="Square" StrokeStartLineCap="Square" 
                                                            x:Name="r_T"
                                                            Grid.Column="16"
                                                            Height="5"
                                                            Margin="0,-5,0,0"
                                                            HorizontalAlignment="Right"
                                                            VerticalAlignment="Top"
                                                            Stretch="Fill"
                                                            Stroke="Black" />

                                                        <!--  //////////////////////////////////////////////////  -->
                                                        <!--  Selector  -->
                                                        <!--  //////////////////////////////////////////////////  -->
                                                        <Path
                                                            x:Name="selector"
                                                            Grid.Column="0"
                                                            Grid.ColumnSpan="9"
                                                            Data="M0,0 L1,1"
                                                            Stretch="Fill"
                                                            Stroke="Black" />
                                                    </Grid>
                                                    <DataTemplate.Triggers>
                                                        <DataTrigger Binding="{Value SW}" Value="2">
                                                            <Setter TargetName="selector" Property="Grid.Column" Value="1" />
                                                            <Setter TargetName="selector" Property="Grid.ColumnSpan" Value="8" />
                                                            <Setter TargetName="selector" Property="Data" Value="M0,0 L1,1" />
                                                        </DataTrigger>
                                                        <DataTrigger Binding="{Value SW}" Value="3">
                                                            <Setter TargetName="selector" Property="Grid.Column" Value="5" />
                                                            <Setter TargetName="selector" Property="Grid.ColumnSpan" Value="4" />
                                                            <Setter TargetName="selector" Property="Data" Value="M0,0 L1,1" />
                                                        </DataTrigger>
                                                        <DataTrigger Binding="{Value SW}" Value="4">
                                                            <Setter TargetName="selector" Property="Grid.Column" Value="8" />
                                                            <Setter TargetName="selector" Property="Grid.ColumnSpan" Value="1" />
                                                            <Setter TargetName="selector" Property="Data" Value="M0,0 L1,1" />
                                                            <Setter TargetName="selector" Property="HorizontalAlignment" Value="Right" />
                                                        </DataTrigger>
                                                        <DataTrigger Binding="{Value SW}" Value="5">
                                                            <Setter TargetName="selector" Property="Grid.Column" Value="9" />
                                                            <Setter TargetName="selector" Property="Grid.ColumnSpan" Value="1" />
                                                            <Setter TargetName="selector" Property="Data" Value="M0,1 L1,0" />
                                                        </DataTrigger>
                                                        <DataTrigger Binding="{Value SW}" Value="6">
                                                            <Setter TargetName="selector" Property="Grid.Column" Value="9" />
                                                            <Setter TargetName="selector" Property="Grid.ColumnSpan" Value="4" />
                                                            <Setter TargetName="selector" Property="Data" Value="M0,1 L1,0" />
                                                        </DataTrigger>
                                                        <DataTrigger Binding="{Value SW}" Value="7">
                                                            <Setter TargetName="selector" Property="Grid.Column" Value="9" />
                                                            <Setter TargetName="selector" Property="Grid.ColumnSpan" Value="8" />
                                                            <Setter TargetName="selector" Property="Data" Value="M0,1 L1,0" />
                                                        </DataTrigger>
                                                        <DataTrigger Binding="{Value SW}" Value="8">
                                                            <Setter TargetName="selector" Property="Grid.Column" Value="9" />
                                                            <Setter TargetName="selector" Property="Grid.ColumnSpan" Value="9" />
                                                            <Setter TargetName="selector" Property="Data" Value="M0,1 L1,0" />
                                                        </DataTrigger>
                                                    </DataTemplate.Triggers>
                                                </DataTemplate>
                                            </Setter.Value>
                                        </Setter>


                                        <Style.Triggers>

                                            <!--  NC = 7  -->
                                            <DataTrigger Binding="{Value NC}" Value="7">
                                                <Setter Property="ContentTemplate">
                                                    <Setter.Value>
                                                        <DataTemplate>
                                                            <Grid x:Name="Draw7">
                                                                <Grid.ColumnDefinitions>
                                                                    <ColumnDefinition Width="10*" />
                                                                    <ColumnDefinition Width="1.6*" />
                                                                    <ColumnDefinition Width="2.4*" />
                                                                    <ColumnDefinition Width="3.5*" />
                                                                    <ColumnDefinition Width="2.5*" />
                                                                    <ColumnDefinition Width="3.2*" />
                                                                    <ColumnDefinition Width="4.8*" />
                                                                    <ColumnDefinition Width="2*" />
                                                                    <ColumnDefinition Width="5*" />

                                                                    <ColumnDefinition Width="5*" />
                                                                    <ColumnDefinition Width="2*" />
                                                                    <ColumnDefinition Width="4.8*" />
                                                                    <ColumnDefinition Width="3.2*" />
                                                                    <ColumnDefinition Width="2.5*" />
                                                                    <ColumnDefinition Width="3.5*" />
                                                                    <ColumnDefinition Width="2.4*" />
                                                                    <ColumnDefinition Width="1.6*" />
                                                                    <ColumnDefinition Width="10*" />
                                                                </Grid.ColumnDefinitions>
                                                                <Line  Y2="1" StrokeEndLineCap="Square" StrokeStartLineCap="Square" 
                                                                    x:Name="c_T"
                                                                    Grid.Column="2"
                                                                    Height="5"
                                                                    Margin="0,-5,0,0"
                                                                    HorizontalAlignment="Left"
                                                                    VerticalAlignment="Top"
                                                                    Stretch="Fill"
                                                                    Stroke="Black" />
                                                                <Line  Y2="1" StrokeEndLineCap="Square" StrokeStartLineCap="Square" 
                                                                    x:Name="g_T"
                                                                    Grid.Column="6"
                                                                    Height="5"
                                                                    Margin="0,-5,0,0"
                                                                    HorizontalAlignment="Left"
                                                                    VerticalAlignment="Top"
                                                                    Stretch="Fill"
                                                                    Stroke="Black" />
                                                                <Line  Y2="1" StrokeEndLineCap="Square" StrokeStartLineCap="Square" 
                                                                    x:Name="j_T"
                                                                    Grid.Column="8"
                                                                    Height="5"
                                                                    Margin="0,-5,0,0"
                                                                    HorizontalAlignment="Right"
                                                                    VerticalAlignment="Top"
                                                                    Stretch="Fill"
                                                                    Stroke="Black" />
                                                                <Line  Y2="1" StrokeEndLineCap="Square" StrokeStartLineCap="Square" 
                                                                    x:Name="m_T"
                                                                    Grid.Column="11"
                                                                    Height="5"
                                                                    Margin="0,-5,0,0"
                                                                    HorizontalAlignment="Right"
                                                                    VerticalAlignment="Top"
                                                                    Stretch="Fill"
                                                                    Stroke="Black" />
                                                                <Line  Y2="1" StrokeEndLineCap="Square" StrokeStartLineCap="Square" 
                                                                    x:Name="q_T"
                                                                    Grid.Column="15"
                                                                    Height="5"
                                                                    Margin="0,-5,0,0"
                                                                    HorizontalAlignment="Right"
                                                                    VerticalAlignment="Top"
                                                                    Stretch="Fill"
                                                                    Stroke="Black" />

                                                                <!--  //////////////////////////////////////////////////  -->
                                                                <!--  Selector  -->
                                                                <!--  //////////////////////////////////////////////////  -->
                                                                <Path
                                                                    x:Name="selector"
                                                                    Grid.Column="0"
                                                                    Grid.ColumnSpan="9"
                                                                    Data="M0,0 L1,1"
                                                                    Stretch="Fill"
                                                                    Stroke="Black" />
                                                            </Grid>
                                                            <DataTemplate.Triggers>
                                                                <DataTrigger Binding="{Value SW}" Value="2">
                                                                    <Setter TargetName="selector" Property="Grid.Column" Value="2" />
                                                                    <Setter TargetName="selector" Property="Grid.ColumnSpan" Value="7" />
                                                                    <Setter TargetName="selector" Property="Data" Value="M0,0 L1,1" />
                                                                </DataTrigger>
                                                                <DataTrigger Binding="{Value SW}" Value="3">
                                                                    <Setter TargetName="selector" Property="Grid.Column" Value="6" />
                                                                    <Setter TargetName="selector" Property="Grid.ColumnSpan" Value="3" />
                                                                    <Setter TargetName="selector" Property="Data" Value="M0,0 L1,1" />
                                                                </DataTrigger>
                                                                <DataTrigger Binding="{Value SW}" Value="4">
                                                                    <Setter TargetName="selector" Property="Grid.Column" Value="8" />
                                                                    <Setter TargetName="selector" Property="Grid.ColumnSpan" Value="1" />
                                                                    <Setter TargetName="selector" Property="Data" Value="M0,0 L0,1" />
                                                                    <Setter TargetName="selector" Property="HorizontalAlignment" Value="Right" />
                                                                </DataTrigger>
                                                                <DataTrigger Binding="{Value SW}" Value="5">
                                                                    <Setter TargetName="selector" Property="Grid.Column" Value="9" />
                                                                    <Setter TargetName="selector" Property="Grid.ColumnSpan" Value="3" />
                                                                    <Setter TargetName="selector" Property="Data" Value="M0,1 L1,0" />
                                                                </DataTrigger>
                                                                <DataTrigger Binding="{Value SW}" Value="6">
                                                                    <Setter TargetName="selector" Property="Grid.Column" Value="9" />
                                                                    <Setter TargetName="selector" Property="Grid.ColumnSpan" Value="7" />
                                                                    <Setter TargetName="selector" Property="Data" Value="M0,1 L1,0" />
                                                                </DataTrigger>
                                                                <DataTrigger Binding="{Value SW}" Value="7">
                                                                    <Setter TargetName="selector" Property="Grid.Column" Value="9" />
                                                                    <Setter TargetName="selector" Property="Grid.ColumnSpan" Value="9" />
                                                                    <Setter TargetName="selector" Property="Data" Value="M0,1 L1,0" />
                                                                </DataTrigger>
                                                            </DataTemplate.Triggers>
                                                        </DataTemplate>
                                                    </Setter.Value>
                                                </Setter>
                                            </DataTrigger>

                                            <!--  NC = 6  -->
                                            <DataTrigger Binding="{Value NC}" Value="5">
                                                <Setter Property="ContentTemplate">
                                                    <Setter.Value>
                                                        <DataTemplate>
                                                            <Grid x:Name="Draw6">
                                                                <Grid.ColumnDefinitions>
                                                                    <ColumnDefinition Width="10*" />
                                                                    <ColumnDefinition Width="1.6*" />
                                                                    <ColumnDefinition Width="2.4*" />
                                                                    <ColumnDefinition Width="3.5*" />
                                                                    <ColumnDefinition Width="2.5*" />
                                                                    <ColumnDefinition Width="3.2*" />
                                                                    <ColumnDefinition Width="4.8*" />
                                                                    <ColumnDefinition Width="2*" />
                                                                    <ColumnDefinition Width="5*" />

                                                                    <ColumnDefinition Width="5*" />
                                                                    <ColumnDefinition Width="2*" />
                                                                    <ColumnDefinition Width="4.8*" />
                                                                    <ColumnDefinition Width="3.2*" />
                                                                    <ColumnDefinition Width="2.5*" />
                                                                    <ColumnDefinition Width="3.5*" />
                                                                    <ColumnDefinition Width="2.4*" />
                                                                    <ColumnDefinition Width="1.6*" />
                                                                    <ColumnDefinition Width="10*" />
                                                                </Grid.ColumnDefinitions>
                                                                <Line  Y2="1" StrokeEndLineCap="Square" StrokeStartLineCap="Square" 
                                                                    x:Name="d_T"
                                                                    Grid.Column="3"
                                                                    Height="5"
                                                                    Margin="0,-5,0,0"
                                                                    HorizontalAlignment="Left"
                                                                    VerticalAlignment="Top"
                                                                    Stretch="Fill"
                                                                    Stroke="Black" />
                                                                <Line  Y2="1" StrokeEndLineCap="Square" StrokeStartLineCap="Square" 
                                                                    x:Name="h_T"
                                                                    Grid.Column="7"
                                                                    Height="5"
                                                                    Margin="0,-5,0,0"
                                                                    HorizontalAlignment="Left"
                                                                    VerticalAlignment="Top"
                                                                    Stretch="Fill"
                                                                    Stroke="Black" />
                                                                <Line  Y2="1" StrokeEndLineCap="Square" StrokeStartLineCap="Square" 
                                                                    x:Name="l_T"
                                                                    Grid.Column="10"
                                                                    Height="5"
                                                                    Margin="0,-5,0,0"
                                                                    HorizontalAlignment="Right"
                                                                    VerticalAlignment="Top"
                                                                    Stretch="Fill"
                                                                    Stroke="Black" />
                                                                <Line  Y2="1" StrokeEndLineCap="Square" StrokeStartLineCap="Square" 
                                                                    x:Name="p_T"
                                                                    Grid.Column="14"
                                                                    Height="5"
                                                                    Margin="0,-5,0,0"
                                                                    HorizontalAlignment="Right"
                                                                    VerticalAlignment="Top"
                                                                    Stretch="Fill"
                                                                    Stroke="Black" />

                                                                <!--  //////////////////////////////////////////////////  -->
                                                                <!--  Selector  -->
                                                                <!--  //////////////////////////////////////////////////  -->
                                                                <Path
                                                                    x:Name="selector"
                                                                    Grid.Column="0"
                                                                    Grid.ColumnSpan="9"
                                                                    Data="M0,0 L1,1"
                                                                    Stretch="Fill"
                                                                    Stroke="Black" />
                                                            </Grid>
                                                            <DataTemplate.Triggers>
                                                                <DataTrigger Binding="{Value SW}" Value="2">
                                                                    <Setter TargetName="selector" Property="Grid.Column" Value="3" />
                                                                    <Setter TargetName="selector" Property="Grid.ColumnSpan" Value="6" />
                                                                    <Setter TargetName="selector" Property="Data" Value="M0,0 L1,1" />
                                                                </DataTrigger>
                                                                <DataTrigger Binding="{Value SW}" Value="3">
                                                                    <Setter TargetName="selector" Property="Grid.Column" Value="7" />
                                                                    <Setter TargetName="selector" Property="Grid.ColumnSpan" Value="2" />
                                                                    <Setter TargetName="selector" Property="Data" Value="M0,0 L1,1" />
                                                                </DataTrigger>
                                                                <DataTrigger Binding="{Value SW}" Value="4">
                                                                    <Setter TargetName="selector" Property="Grid.Column" Value="9" />
                                                                    <Setter TargetName="selector" Property="Grid.ColumnSpan" Value="2" />
                                                                    <Setter TargetName="selector" Property="Data" Value="M0,1 L1,0" />
                                                                </DataTrigger>
                                                                <DataTrigger Binding="{Value SW}" Value="5">
                                                                    <Setter TargetName="selector" Property="Grid.Column" Value="9" />
                                                                    <Setter TargetName="selector" Property="Grid.ColumnSpan" Value="6" />
                                                                    <Setter TargetName="selector" Property="Data" Value="M0,1 L1,0" />
                                                                </DataTrigger>
                                                                <DataTrigger Binding="{Value SW}" Value="6">
                                                                    <Setter TargetName="selector" Property="Grid.Column" Value="9" />
                                                                    <Setter TargetName="selector" Property="Grid.ColumnSpan" Value="9" />
                                                                    <Setter TargetName="selector" Property="Data" Value="M0,1 L1,0" />
                                                                </DataTrigger>
                                                            </DataTemplate.Triggers>
                                                        </DataTemplate>
                                                    </Setter.Value>
                                                </Setter>
                                            </DataTrigger>

                                            <!--  NC = 5  -->
                                            <DataTrigger Binding="{Value NC}" Value="5">
                                                <Setter Property="ContentTemplate">
                                                    <Setter.Value>
                                                        <DataTemplate>
                                                            <Grid x:Name="Draw5">
                                                                <Grid.ColumnDefinitions>
                                                                    <ColumnDefinition Width="10*" />
                                                                    <ColumnDefinition Width="1.6*" />
                                                                    <ColumnDefinition Width="2.4*" />
                                                                    <ColumnDefinition Width="3.5*" />
                                                                    <ColumnDefinition Width="2.5*" />
                                                                    <ColumnDefinition Width="3.2*" />
                                                                    <ColumnDefinition Width="4.8*" />
                                                                    <ColumnDefinition Width="2*" />
                                                                    <ColumnDefinition Width="5*" />

                                                                    <ColumnDefinition Width="5*" />
                                                                    <ColumnDefinition Width="2*" />
                                                                    <ColumnDefinition Width="4.8*" />
                                                                    <ColumnDefinition Width="3.2*" />
                                                                    <ColumnDefinition Width="2.5*" />
                                                                    <ColumnDefinition Width="3.5*" />
                                                                    <ColumnDefinition Width="2.4*" />
                                                                    <ColumnDefinition Width="1.6*" />
                                                                    <ColumnDefinition Width="10*" />
                                                                </Grid.ColumnDefinitions>
                                                                <Line  Y2="1" StrokeEndLineCap="Square" StrokeStartLineCap="Square" 
                                                                    x:Name="e_T"
                                                                    Grid.Column="4"
                                                                    Height="5"
                                                                    Margin="0,-5,0,0"
                                                                    HorizontalAlignment="Left"
                                                                    VerticalAlignment="Top"
                                                                    Stretch="Fill"
                                                                    Stroke="Black" />
                                                                <Line  Y2="1" StrokeEndLineCap="Square" StrokeStartLineCap="Square" 
                                                                    x:Name="j_T"
                                                                    Grid.Column="8"
                                                                    Height="5"
                                                                    Margin="0,-5,0,0"
                                                                    HorizontalAlignment="Right"
                                                                    VerticalAlignment="Top"
                                                                    Stretch="Fill"
                                                                    Stroke="Black" />
                                                                <Line  Y2="1" StrokeEndLineCap="Square" StrokeStartLineCap="Square" 
                                                                    x:Name="o_T"
                                                                    Grid.Column="12"
                                                                    Height="5"
                                                                    Margin="0,-5,0,0"
                                                                    HorizontalAlignment="Right"
                                                                    VerticalAlignment="Top"
                                                                    Stretch="Fill"
                                                                    Stroke="Black" />

                                                                <!--  //////////////////////////////////////////////////  -->
                                                                <!--  Selector  -->
                                                                <!--  //////////////////////////////////////////////////  -->
                                                                <Path
                                                                    x:Name="selector"
                                                                    Grid.Column="0"
                                                                    Grid.ColumnSpan="9"
                                                                    Data="M0,0 L1,1"
                                                                    Stretch="Fill"
                                                                    Stroke="Black" />
                                                            </Grid>
                                                            <DataTemplate.Triggers>
                                                                <DataTrigger Binding="{Value SW}" Value="2">
                                                                    <Setter TargetName="selector" Property="Grid.Column" Value="4" />
                                                                    <Setter TargetName="selector" Property="Grid.ColumnSpan" Value="5" />
                                                                    <Setter TargetName="selector" Property="Data" Value="M0,0 L1,1" />
                                                                </DataTrigger>
                                                                <DataTrigger Binding="{Value SW}" Value="3">
                                                                    <Setter TargetName="selector" Property="Grid.Column" Value="8" />
                                                                    <Setter TargetName="selector" Property="Grid.ColumnSpan" Value="1" />
                                                                    <Setter TargetName="selector" Property="Data" Value="M0,0 L0,1" />
                                                                    <Setter TargetName="selector" Property="HorizontalAlignment" Value="Right" />
                                                                </DataTrigger>
                                                                <DataTrigger Binding="{Value SW}" Value="4">
                                                                    <Setter TargetName="selector" Property="Grid.Column" Value="9" />
                                                                    <Setter TargetName="selector" Property="Grid.ColumnSpan" Value="4" />
                                                                    <Setter TargetName="selector" Property="Data" Value="M0,1 L1,0" />
                                                                </DataTrigger>
                                                                <DataTrigger Binding="{Value SW}" Value="5">
                                                                    <Setter TargetName="selector" Property="Grid.Column" Value="9" />
                                                                    <Setter TargetName="selector" Property="Grid.ColumnSpan" Value="9" />
                                                                    <Setter TargetName="selector" Property="Data" Value="M0,1 L1,0" />
                                                                </DataTrigger>
                                                            </DataTemplate.Triggers>
                                                        </DataTemplate>
                                                    </Setter.Value>
                                                </Setter>
                                            </DataTrigger>


                                        </Style.Triggers>
                                    </Style>
                                </ContentControl.Style>

                            </ContentControl>




                            <Line x:Name="left"  HorizontalAlignment="Left" />
                            <Line x:Name="right"  HorizontalAlignment="Right" />

                            <Line x:Name="bottom" HorizontalAlignment="Center" VerticalAlignment="Bottom" Margin="0,0,0,-8" Height="8"/>
                            
                            <Border BorderBrush="Black" BorderThickness="1"/>

                        </Grid>
                        
                        <!--  TagName  -->
                        <TextBlock
                            x:Name="Tagname"
                            HorizontalAlignment="Left"
                            VerticalAlignment="Center"
                            FontWeight="{TemplateBinding FontWeight}"
                            Text="{TemplateBinding TagName}"
                            Visibility="{TAGNAMESBinding}" 
                            Grid.Column="1" 
                            Margin="2,0,-100,0" />

                    </Grid>

                </ControlTemplate>
            </Setter.Value>
        </Setter>
    </Style>

    <Style x:Key="RSI_StdSelectorIn_5to8Style" TargetType="{x:Type RSI_StdSelectorIn}">
        <Setter Property="Width" Value="70"/>
        <Setter Property="Height" Value="43"/>
        <Setter Property="Background" Value="Green"/>
        <Setter Property="Template">
            <Setter.Value>
                <ControlTemplate TargetType="{x:Type RSI_StdSelectorIn}">
                    <Grid x:Name="MainGrid" Background="{TemplateBinding Background}">
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="*"/>
                            <ColumnDefinition Width="Auto"/>
                        </Grid.ColumnDefinitions>

                        <Grid x:Name="Draw">
                            <Grid.RowDefinitions>
                                <RowDefinition Height="5" />
                                <RowDefinition Height="*" />
                                <RowDefinition Height="8" />
                            </Grid.RowDefinitions>
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="2*" />
                                <ColumnDefinition Width="1.6" />
                                <ColumnDefinition Width="2.4" />
                                <ColumnDefinition Width="3.5" />
                                <ColumnDefinition Width="2.5" />
                                <ColumnDefinition Width="3.2" />
                                <ColumnDefinition Width="4.8" />
                                <ColumnDefinition Width="2" />
                                <ColumnDefinition Width="*" />

                                <ColumnDefinition Width="*" />
                                <ColumnDefinition Width="2" />
                                <ColumnDefinition Width="4.8" />
                                <ColumnDefinition Width="3.2" />
                                <ColumnDefinition Width="2.5" />
                                <ColumnDefinition Width="3.5" />
                                <ColumnDefinition Width="2.4" />
                                <ColumnDefinition Width="1.6" />
                                <ColumnDefinition Width="2*" />
                            </Grid.ColumnDefinitions>

                            <!--  //////////////////////////////////////////////////  -->
                            <!--  Row 0 Content  -->
                            <!--  Name= a..s + T for Top  -->
                            <!--  //////////////////////////////////////////////////  -->

                            <Line Y2="1" StrokeEndLineCap="Square" StrokeStartLineCap="Square" 
                                  x:Name="a_T"
                                  HorizontalAlignment="Left"
                                  Stretch="Fill"
                                  Stroke="Black" />

                            <Line Y2="1" StrokeEndLineCap="Square" StrokeStartLineCap="Square" 
                                  x:Name="b_T"
                                  Grid.Column="1"
                                  HorizontalAlignment="Left"
                                  Stretch="Fill"
                                  Stroke="BlueViolet"
                                  Visibility="{Value NC,
                                                Converter={IsEqualTo 8}}" />

                            <Line Y2="1" StrokeEndLineCap="Square" StrokeStartLineCap="Square" 
                                  x:Name="c_T"
                                  Grid.Column="2"
                                  HorizontalAlignment="Left"
                                  Stretch="Fill"
                                  Stroke="Blue"
                                  Visibility="{Value NC,
                                                Converter={IsEqualTo 7}}" />

                            <Line Y2="1" StrokeEndLineCap="Square" StrokeStartLineCap="Square" 
                                  x:Name="d_T"
                                  Grid.Column="3"
                                  HorizontalAlignment="Left"
                                  Stretch="Fill"
                                  Stroke="DarkOrange"
                                  Visibility="{Value NC,
                                                Converter={IsEqualTo 6}}" />

                            <Line Y2="1" StrokeEndLineCap="Square" StrokeStartLineCap="Square" 
                                  x:Name="e_T"
                                  Grid.Column="4"
                                  HorizontalAlignment="Left"
                                  Stretch="Fill"
                                  Stroke="Black"
                                  Visibility="{Value NC,
                                                Converter={IsEqualTo 5}}" />

                            <Line Y2="1" StrokeEndLineCap="Square" StrokeStartLineCap="Square" 
                                  x:Name="f_T"
                                  Grid.Column="5"
                                  HorizontalAlignment="Left"
                                  Stretch="Fill"
                                  Stroke="BlueViolet"
                                  Visibility="{Value NC,
                                                Converter={IsEqualTo 8}}" />

                            <Line Y2="1" StrokeEndLineCap="Square" StrokeStartLineCap="Square" 
                                  x:Name="g_T"
                                  Grid.Column="6"
                                  HorizontalAlignment="Left"
                                  Stretch="Fill"
                                  Stroke="Blue"
                                  Visibility="{Value NC,
                                                Converter={IsEqualTo 7}}" />

                            <Line Y2="1" StrokeEndLineCap="Square" StrokeStartLineCap="Square" 
                                  x:Name="h_T"
                                  Grid.Column="7"
                                  HorizontalAlignment="Left"
                                  Stretch="Fill"
                                  Stroke="DarkOrange"
                                  Visibility="{Value NC,
                                                Converter={IsEqualTo 6}}" />

                            <Line Y2="1" StrokeEndLineCap="Square" StrokeStartLineCap="Square" 
                                  x:Name="i_T"
                                  Grid.Column="8"
                                  HorizontalAlignment="Left"
                                  Stretch="Fill"
                                  Stroke="BlueViolet"
                                  Visibility="{Value NC,
                                                Converter={IsEqualTo 8}}" />

                            <Line StrokeEndLineCap="Square" StrokeStartLineCap="Square" 
                                  x:Name="j_T"
                                  Grid.Column="8"
                                  HorizontalAlignment="Right"
                                  Stretch="Fill"
                                  Stroke="Black" 
                                  Y2="1"
                                  Visibility="{Value NC , Converter={IsEqualTo 5:7}}"/>


                            <Line Y2="1" StrokeEndLineCap="Square" StrokeStartLineCap="Square" 
                                  x:Name="k_T"
                                  Grid.Column="9"
                                  HorizontalAlignment="Right"
                                  Stretch="Fill"
                                  Stroke="BlueViolet"
                                  Visibility="{Value NC,
                                                Converter={IsEqualTo 8}}" />
                            <Line Y2="1" StrokeEndLineCap="Square" StrokeStartLineCap="Square" 
                                  x:Name="l_T"
                                  Grid.Column="10"
                                  HorizontalAlignment="Right"
                                  Stretch="Fill"
                                  Stroke="DarkOrange"
                                  Visibility="{Value NC,
                                                Converter={IsEqualTo 6}}" />
                            <Line Y2="1" StrokeEndLineCap="Square" StrokeStartLineCap="Square" 
                                  x:Name="m_T"
                                  Grid.Column="11"
                                  HorizontalAlignment="Right"
                                  Stretch="Fill"
                                  Stroke="Blue"
                                  Visibility="{Value NC,
                                                Converter={IsEqualTo 7}}" />
                            <Line Y2="1" StrokeEndLineCap="Square" StrokeStartLineCap="Square" 
                                  x:Name="n_T"
                                  Grid.Column="12"
                                  HorizontalAlignment="Right"
                                  Stretch="Fill"
                                  Stroke="BlueViolet"
                                  Visibility="{Value NC,
                                                Converter={IsEqualTo 8}}" />
                            <Line Y2="1" StrokeEndLineCap="Square" StrokeStartLineCap="Square" 
                                  x:Name="o_T"
                                  Grid.Column="13"
                                  HorizontalAlignment="Right"
                                  Stretch="Fill"
                                  Stroke="Black"
                                  Visibility="{Value NC,
                                                Converter={IsEqualTo 5}}" />
                            <Line Y2="1" StrokeEndLineCap="Square" StrokeStartLineCap="Square" 
                                  x:Name="p_T"
                                  Grid.Column="14"
                                  HorizontalAlignment="Right"
                                  Stretch="Fill"
                                  Stroke="DarkOrange"
                                  Visibility="{Value NC,
                                                Converter={IsEqualTo 6}}" />
                            <Line Y2="1" StrokeEndLineCap="Square" StrokeStartLineCap="Square" 
                                  x:Name="q_T"
                                  Grid.Column="15"
                                  HorizontalAlignment="Right"
                                  Stretch="Fill"
                                  Stroke="Blue"
                                  Visibility="{Value NC,
                                                Converter={IsEqualTo 7}}" />
                            <Line Y2="1" StrokeEndLineCap="Square" StrokeStartLineCap="Square" 
                                  x:Name="r_T"
                                  Grid.Column="16"
                                  HorizontalAlignment="Right"
                                  Stretch="Fill"
                                  Stroke="BlueViolet"
                                  Visibility="{Value NC,
                                                Converter={IsEqualTo 8}}" />
                            <Line Y2="1" StrokeEndLineCap="Square" StrokeStartLineCap="Square" 
                                  x:Name="s_T"
                                  Grid.Column="17"
                                  HorizontalAlignment="Right"                                      
                                  Stretch="Fill"
                                  Stroke="Black" />

                            <!--  //////////////////////////////////////////////////  -->
                            <!--  Row 1 Content  -->
                            <!--  //////////////////////////////////////////////////  -->                            
                            
                            <Path x:Name="a"
                                  Grid.Row="1"
                                  Grid.Column="0"
                                  Grid.ColumnSpan="9"
                                  Data="M0,0 L1,1"                      
                                  Stretch="Fill"
                                  Stroke="Black"
                                  Visibility="{Value SW , Converter={IsEqualTo 1}}"/>


                            <RSIPath x:Name="b"
                                     Grid.Row="1"
                                     Grid.Column="1"
                                     Grid.ColumnSpan="8"
                                     Data="M0,0 L1,1"                      
                                     Stretch="Fill"
                                     Stroke="BlueViolet">
                                <RSIPath.Animations>
                                    <!-- Visisble si NC=8 et SW=2 -->
                                    <Animation Condition="$TAGNAME.NC != 8 OR $TAGNAME.SW != 2">
                                        <Invisible/>
                                    </Animation>
                                </RSIPath.Animations>
                            </RSIPath>

                            <RSIPath x:Name="c"
                                     Grid.Row="1"
                                     Grid.Column="2"
                                     Grid.ColumnSpan="7"
                                     Data="M0,0 L1,1"                      
                                     Stretch="Fill"
                                     Stroke="Blue">
                                <RSIPath.Animations>
                                    <!-- Visisble si NC=7 et SW=2 -->
                                    <Animation Condition="$TAGNAME.NC != 7 OR $TAGNAME.SW != 2">
                                        <Invisible/>
                                    </Animation>
                                </RSIPath.Animations>
                            </RSIPath>

                            <RSIPath x:Name="d"
                                     Grid.Row="1"
                                     Grid.Column="3"
                                     Grid.ColumnSpan="6"
                                     Data="M0,0 L1,1"                      
                                     Stretch="Fill"
                                     Stroke="DarkOrange">
                                <RSIPath.Animations>
                                    <!-- Visisble si NC=6 et SW=2 -->
                                    <Animation Condition="$TAGNAME.NC != 6 OR $TAGNAME.SW != 2">
                                        <Invisible/>
                                    </Animation>
                                </RSIPath.Animations>
                            </RSIPath>
                            
                            <RSIPath x:Name="e"
                                     Grid.Row="1"
                                     Grid.Column="4"
                                     Grid.ColumnSpan="5"
                                     Data="M0,0 L1,1"                      
                                     Stretch="Fill"
                                     Stroke="Yellow">
                                <RSIPath.Animations>
                                    <!-- Visisble si NC=5 et SW=2 -->
                                    <Animation Condition="$TAGNAME.NC != 5 OR $TAGNAME.SW != 2">
                                        <Invisible/>
                                    </Animation>
                                </RSIPath.Animations>
                            </RSIPath>
                            
                            <RSIPath x:Name="f"
                                     Grid.Row="1"
                                     Grid.Column="5"
                                     Grid.ColumnSpan="4"
                                     Data="M0,0 L1,1"                      
                                     Stretch="Fill"
                                     Stroke="BlueViolet">
                                <RSIPath.Animations>
                                    <!-- Visisble si NC=8 et SW=3 -->
                                    <Animation Condition="$TAGNAME.NC != 8 OR $TAGNAME.SW != 3">
                                        <Invisible/>
                                    </Animation>
                                </RSIPath.Animations>
                            </RSIPath>
                            
                            <RSIPath x:Name="g"
                                     Grid.Row="1"
                                     Grid.Column="6"
                                     Grid.ColumnSpan="3"
                                     Data="M0,0 L1,1"                      
                                     Stretch="Fill"
                                     Stroke="Blue">
                                <RSIPath.Animations>
                                    <!-- Visisble si NC=7 et SW=3 -->
                                    <Animation Condition="$TAGNAME.NC != 7 OR $TAGNAME.SW != 3">
                                        <Invisible/>
                                    </Animation>
                                </RSIPath.Animations>
                            </RSIPath>
                            
                            <RSIPath x:Name="h"
                                     Grid.Row="1"
                                     Grid.Column="7"
                                     Grid.ColumnSpan="2"
                                     Data="M0,0 L1,1"                      
                                     Stretch="Fill"
                                     Stroke="DarkOrange">
                                <RSIPath.Animations>
                                    <!-- Visisble si NC=6 et SW=3 -->
                                    <Animation Condition="$TAGNAME.NC != 6 OR $TAGNAME.SW != 3">
                                        <Invisible/>
                                    </Animation>
                                </RSIPath.Animations>
                            </RSIPath>

                            <RSIPath x:Name="i"
                                     Grid.Row="1"
                                     Grid.Column="8"
                                     Data="M0,0 L1,1"                      
                                     Stretch="Fill"
                                     Stroke="BlueViolet">
                                <RSIPath.Animations>
                                    <!-- Visisble si NC=8 et SW=4 -->
                                    <Animation Condition="$TAGNAME.NC != 8 OR $TAGNAME.SW != 4">
                                        <Invisible/>
                                    </Animation>
                                </RSIPath.Animations>
                            </RSIPath>

                            <RSIPath x:Name="j"
                                     Grid.Row="1"
                                     Grid.Column="8"
                                     HorizontalAlignment="Right"
                                     Data="M0,0 L0,1"                      
                                     Stretch="Fill"
                                     Stroke="Blue">
                                <RSIPath.Animations>
                                    <!-- Visisble si NC=7 et SW=4 ou  NC=5 et SW=3 -->
                                    <Animation Condition="($TAGNAME.NC != 5 OR $TAGNAME.SW != 3) AND ($TAGNAME.NC != 7 OR $TAGNAME.SW != 4)">
                                        <Invisible/>
                                    </Animation>
                                </RSIPath.Animations>
                            </RSIPath>

                            <RSIPath x:Name="k"
                                     Grid.Row="1"
                                     Grid.Column="9"
                                     Data="M0,1 L1,0"                      
                                     Stretch="Fill"
                                     Stroke="BlueViolet">
                                <RSIPath.Animations>
                                    <!-- Visisble si NC=8 et SW=5 -->
                                    <Animation Condition="$TAGNAME.NC != 8 OR $TAGNAME.SW != 5">
                                        <Invisible/>
                                    </Animation>
                                </RSIPath.Animations>
                            </RSIPath>

                            <RSIPath x:Name="l"
                                     Grid.Row="1"
                                     Grid.Column="9"
                                     Grid.ColumnSpan="2"
                                     Data="M0,1 L1,0"                      
                                     Stretch="Fill"
                                     Stroke="DarkOrange">
                                <RSIPath.Animations>
                                    <!-- Visisble si NC=6 et SW=4 -->
                                    <Animation Condition="$TAGNAME.NC != 6 OR $TAGNAME.SW != 4">
                                        <Invisible/>
                                    </Animation>
                                </RSIPath.Animations>
                            </RSIPath>

                            <RSIPath x:Name="m"
                                     Grid.Row="1"
                                     Grid.Column="9"
                                     Grid.ColumnSpan="3"
                                     Data="M0,1 L1,0"                      
                                     Stretch="Fill"
                                     Stroke="Blue">
                                <RSIPath.Animations>
                                    <!-- Visisble si NC=7 et SW=5 -->
                                    <Animation Condition="$TAGNAME.NC != 7 OR $TAGNAME.SW != 5">
                                        <Invisible/>
                                    </Animation>
                                </RSIPath.Animations>
                            </RSIPath>

                            <RSIPath x:Name="n"
                                     Grid.Row="1"
                                     Grid.Column="9"
                                     Grid.ColumnSpan="4"
                                     Data="M0,1 L1,0"                      
                                     Stretch="Fill"
                                     Stroke="BlueViolet">
                                <RSIPath.Animations>
                                    <!-- Visisble si NC=8 et SW=6 -->
                                    <Animation Condition="$TAGNAME.NC != 8 OR $TAGNAME.SW != 6">
                                        <Invisible/>
                                    </Animation>
                                </RSIPath.Animations>
                            </RSIPath>

                            <RSIPath x:Name="o"
                                     Grid.Row="1"
                                     Grid.Column="9"
                                     Grid.ColumnSpan="5"
                                     Data="M0,1 L1,0"                      
                                     Stretch="Fill"
                                     Stroke="Yellow">
                                <RSIPath.Animations>
                                    <!-- Visisble si NC=5 et SW=4 -->
                                    <Animation Condition="$TAGNAME.NC != 5 OR $TAGNAME.SW != 4">
                                        <Invisible/>
                                    </Animation>
                                </RSIPath.Animations>
                            </RSIPath>

                            <RSIPath x:Name="p"
                                     Grid.Row="1"
                                     Grid.Column="9"
                                     Grid.ColumnSpan="6"
                                     Data="M0,1 L1,0"                      
                                     Stretch="Fill"
                                     Stroke="DarkOrange">
                                <RSIPath.Animations>
                                    <!-- Visisble si NC=6 et SW=5 -->
                                    <Animation Condition="$TAGNAME.NC != 6 OR $TAGNAME.SW != 5">
                                        <Invisible/>
                                    </Animation>
                                </RSIPath.Animations>
                            </RSIPath>
                            
                            <RSIPath x:Name="q"
                                     Grid.Row="1"
                                     Grid.Column="9"
                                     Grid.ColumnSpan="7"
                                     Data="M0,1 L1,0"                      
                                     Stretch="Fill"
                                     Stroke="Blue">
                                <RSIPath.Animations>
                                    <!-- Visisble si NC=7 et SW=6 -->
                                    <Animation Condition="$TAGNAME.NC != 7 OR $TAGNAME.SW != 6">
                                        <Invisible/>
                                    </Animation>
                                </RSIPath.Animations>
                            </RSIPath>
                            
                            <RSIPath x:Name="r"
                                     Grid.Row="1"
                                     Grid.Column="9"
                                     Grid.ColumnSpan="8"
                                     Data="M0,1 L1,0"                      
                                     Stretch="Fill"
                                     Stroke="BlueViolet">
                                <RSIPath.Animations>
                                    <!-- Visisble si NC=8 et SW=7 -->
                                    <Animation Condition="$TAGNAME.NC != 8 OR $TAGNAME.SW != 7">
                                        <Invisible/>
                                    </Animation>
                                </RSIPath.Animations>
                            </RSIPath>

                            <RSIPath x:Name="s"
                                     Grid.Row="1"
                                     Grid.Column="9"
                                     Grid.ColumnSpan="9"
                                     Data="M0,1 L1,0"                      
                                     Stretch="Fill"
                                     Stroke="Black">
                                <RSIPath.Animations>
                                    <!-- Visisble si 
                                    NC=5 et SW=5 ou 
                                    NC=6 et SW=6 ou 
                                    NC=7 et SW=7 ou 
                                    NC=8 et SW=8-->
                                    <Animation Condition="($TAGNAME.NC != 5 OR $TAGNAME.SW != 5) AND ($TAGNAME.NC != 6 OR $TAGNAME.SW != 6) AND ($TAGNAME.NC != 7 OR $TAGNAME.SW != 7)  AND ($TAGNAME.NC != 8 OR $TAGNAME.SW != 8)">
                                        <Invisible/>
                                    </Animation>
                                </RSIPath.Animations>
                            </RSIPath>


                            <Border Grid.Row="1"
                                    Grid.ColumnSpan="18"
                                    BorderThickness="1"
                                    BorderBrush="Black"/>

                            <!--  *********************************************************  -->
                            <!--  Bot Part	(Name: 'B' for Bottom)  -->
                            <!--  *********************************************************  -->
                            <Line Y2="1" StrokeEndLineCap="Square" StrokeStartLineCap="Square" 
                                  x:Name="B"
                                  Grid.Row="2"
                                  Grid.Column="8"
                                  Grid.ColumnSpan="2"
                                  Stretch="Fill"
                                  Stroke="Black" />

                        </Grid>

                        <!--  TagName  -->
                        <TextBlock
                            x:Name="Tagname"
                            HorizontalAlignment="Left"
                            VerticalAlignment="Center"
                            FontWeight="{TemplateBinding FontWeight}"
                            Text="{TemplateBinding TagName}"
                            Visibility="{TAGNAMESBinding}" 
                            Grid.Column="1" 
                            Margin="2,0,-100,0" />

                    </Grid>
                </ControlTemplate>
            </Setter.Value>
        </Setter>
    </Style>

    <Style x:Key="RSI_Pump_Esd" TargetType="{x:Type RSI_Pump}">
        <Setter Property="Width" Value="40"/>
        <Setter Property="Height" Value="47"/>
        <Setter Property="ColorStart" Value="Lime"/>
        <Setter Property="ColorStop" Value="White"/>
        <Setter Property="ColorTravel" Value="Lime"/>
        <Setter Property="StandardFaceplateName" Value="Std_FODPump_FacePlate"/>
        <Setter Property="Template">
            <Setter.Value>
                <ControlTemplate TargetType="{x:Type RSI_Pump}">
                    <RSIGrid Background="{TemplateBinding Background}">

                        <Grid x:Name="Pump" >
                            <Grid.RowDefinitions>
                                <RowDefinition Height="*"/>
                                <RowDefinition Height="*"/>
                                <RowDefinition Height="*"/>
                                <RowDefinition Height="*"/>
                                <RowDefinition Height="*"/>
                            </Grid.RowDefinitions>
                            <Path x:Name="socle" 
                                  Fill="{Binding MotorActuator.CurrentColor, RelativeSource={RelativeSource TemplatedParent}}" 
                                  Grid.RowSpan="5"
                                  Stretch="Fill" 
                                  Stroke="Black" 
                                  Data="M1,0 2,2 0,2z"  
                                  HorizontalAlignment="Center" 
                                  VerticalAlignment="Center"/>

                            <Grid x:Name="Body"
                                  Grid.RowSpan="4">
                                <Ellipse Stretch="Fill" 
                                         Stroke="Black" 
                                         HorizontalAlignment="Center" 
                                         VerticalAlignment="Center" 
                                         Height="{Binding ActualHeight, ElementName=Body}"
                                         Width="{Binding ActualWidth, ElementName=Body}">
                                    <Ellipse.Fill>
                                        <RadialGradientBrush>
                                            <GradientStop Color="#FF323232" Offset="1"/>
                                            <GradientStop Color="White" Offset="0.769"/>
                                        </RadialGradientBrush>
                                    </Ellipse.Fill>
                                </Ellipse>
                                <Ellipse x:Name="ellipse" 
                                         Fill="{Binding MotorActuator.CurrentColor, RelativeSource={RelativeSource TemplatedParent}}" 
                                         Stretch="Fill" 
                                         Stroke="Black" 
                                         Height="{Binding ActualHeight, ElementName=Body, Converter={MultiplyConverter RightOperand=0.8}}"
                                         Width="{Binding ActualWidth, ElementName=Body, Converter={MultiplyConverter RightOperand=0.8}}"
                                         HorizontalAlignment="Center" 
                                         VerticalAlignment="Center"
                                         Margin="-5"/>
                                <!-- Inhibition                                 Visibility="{Value $ACCESSMODE\=\=1}"-->
                                <RSIPath x:Name="Inhibition" 
                                         Stretch="Fill" 
                                         Stroke="Black" 
                                         Data="M0,0 1,1 M0,1 1,0"
                                         Height="{Binding ActualHeight, ElementName=Body, Converter={MultiplyConverter RightOperand=0.7}}"
                                         Width="{Binding ActualWidth, ElementName=Body, Converter={MultiplyConverter RightOperand=0.7}}">
                                    <RSIPath.Animations>
                                        <Animation Condition="$MOTORACTUATOR.AvailabilitySwitch = 1">
                                            <Invisible/>
                                        </Animation>
                                    </RSIPath.Animations>
                                </RSIPath>

                            </Grid>
                        </Grid>

                        <!-- ESD -->
                        <RSIBorder x:Name="ESD" BorderBrush="#FFEE1E1E" BorderThickness="2" Margin="-2">
                            <RSIBorder.Animations>
                                <Animation Condition="$MOTORACTUATOR.ESD = 0">
                                    <Invisible/>
                                </Animation>
                            </RSIBorder.Animations>
                        </RSIBorder>

                        <!--  ESD Interlock  -->
                        <RSI_Interlock HorizontalAlignment="Right" 
                                       VerticalAlignment="Bottom" 
                                       Margin="0,0,-20,0"
                                       DataContext="{Binding MotorActuator.Unit, RelativeSource={RelativeSource TemplatedParent}}"
                                       ESDLevelName="{TemplateBinding ESDLevelName}"/>

                        <!-- Failure -->
                        <Flash FailureSource="{Binding MotorActuator.Unit, RelativeSource={RelativeSource TemplatedParent}}" HorizontalAlignment="Right" Margin="0,-10,-10,0" Visibility="Visible" VerticalAlignment="Top" Visitor="{Binding RelativeSource={RelativeSource TemplatedParent}}"/>

                        <!-- TagName-->
                        <TextBlock x:Name="TagName" Text="{TemplateBinding TagName}" Visibility="{TAGNAMESBinding}" HorizontalAlignment="Center" VerticalAlignment="Bottom" Margin="-200,0,-200,-20" />
                        <!-- Value-->
                        <StackPanel DataContext="{ParameterBinding PumpSpeed}" Visibility="{Binding Visibility, ElementName=TagName, Converter={VisibilityToInverseVisibility}}" Orientation="Horizontal" HorizontalAlignment="Right" VerticalAlignment="Bottom" Margin="0,0,0,-20">
                            <TextBlock Text="{Binding Value}" Margin="-100,0,5,0" TextAlignment="Right"/>
                            <TextBlock Text="{Binding UnityName}" />
                        </StackPanel>
                    </RSIGrid>
                </ControlTemplate>
            </Setter.Value>
        </Setter>
    </Style>

    <Style x:Key="RSI_ControlValve_EsdBlockBypass" TargetType="{x:Type RSI_ControlValve}">
        <Setter Property="Width" Value="35"/>
        <Setter Property="Height" Value="40"/>
        <Setter Property="ColorClose" Value="White"/>
        <Setter Property="ColorOpen" Value="Black"/>
        <Setter Property="ColorTravel" Value="Black"/>
        <Setter Property="ColorOpenBypassValve" Value="Black"/>
        <Setter Property="ColorCloseBypassValve" Value="White"/>
        <Setter Property="ColorOpenBlockValve" Value="Black"/>
        <Setter Property="ColorCloseBlockValve" Value="White"/>
        <Setter Property="Template">
            <Setter.Value>
                <ControlTemplate TargetType="{x:Type RSI_ControlValve}">
                    <RSIGrid>
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="Auto"/>
                            <ColumnDefinition Width="*"/>
                            <ColumnDefinition Width="Auto"/>
                        </Grid.ColumnDefinitions>

                        <RSIGrid Background="{TemplateBinding Background}"
                                 Grid.Column="1">
                            <RSIGrid x:Name="path"
                                     RenderTransformOrigin="0.5,0.5">
                                <RSIPath 
                                    Stretch="Fill"
                                    Fill="{Binding ValveActuator.CurrentColor, RelativeSource={RelativeSource TemplatedParent}}"
                                    Data="M47.909677,20.326612L48.213083,54.799194 M92.416664,36.757896L92.083336,72.591228 48.244492,54.607735z M2.9999995,36.047619L48.244492,54.607735 2.9166665,72.924564z M43.070313,1.0046501C44.35677,0.99162912 45.666668,1.0059524 47,1.0476184 70.333336,1.7142854 86,8.0476189 94,20.047619L48,20.047619 1,20.047619C9.75,7.5476189,23.773438,1.1999626,43.070313,1.0046501z"
                                    Stroke="{TemplateBinding BorderBrush}"
                                    StrokeThickness="{TemplateBinding BorderThickness}">
                                    <RSIPath.Animations>
                                        <!-- ESDSensitive AND ESDAction = FailOpen -->
                                        <Animation
                                            Condition="$VALVEACTUATOR.ESDSensitive = true AND $VALVEACTUATOR.ESDAction = 0">
                                            <ChangePropertyValue PropertyName="Data"
                                                                 Value="M48,21 L38,36 58,36 z M48.08125,35.991707 L48.213083,54.799194 M92.416664,36.757896 L92.083336,72.591228 48.244492,54.607735 z M2.9999995,36.047619 L48.244492,54.607735 2.9166665,72.924564 z M43.070313,1.0046501 C44.35677,0.99162912 45.666668,1.0059524 47,1.0476184 70.333336,1.7142854 86,8.0476189 94,20.047619 L48,20.047619 1,20.047619 C9.75,7.5476189 23.773438,1.1999626 43.070313,1.0046501 z" />
                                        </Animation>
                                        <!-- ESDSensitive AND ESDAction = FailClose -->
                                        <Animation
                                            Condition="$VALVEACTUATOR.ESDSensitive = true AND $VALVEACTUATOR.ESDAction = 1">
                                            <ChangePropertyValue PropertyName="Data"
                                                                 Value="M48,53 L38,38 58,38 z M47.909677,20.326612 L48.028409,38.055452 M92.416664,36.757896 L92.083336,72.591228 48.244492,54.607735 z M2.9999995,36.047619 L48.244492,54.607735 2.9166665,72.924564 z M43.070313,1.0046501 C44.35677,0.99162912 45.666668,1.0059524 47,1.0476184 70.333336,1.7142854 86,8.0476189 94,20.047619 L48,20.047619 1,20.047619 C9.75,7.5476189 23.773438,1.1999626 43.070313,1.0046501 z" />
                                        </Animation>
                                        <!-- ESDSensitive AND ESDAction = FailIntermediate or FailPosition -->
                                        <Animation
                                            Condition="$VALVEACTUATOR.ESDSensitive = true AND $VALVEACTUATOR.ESDAction > 1" IsContinuous="True">
                                            <ChangePropertyValue PropertyName="Data"
                                                                 Value="M47.909677,20.326612L48.213083,54.799194 M92.416664,36.757896L92.083336,72.591228 48.244492,54.607735z M2.9999995,36.047619L48.244492,54.607735 2.9166665,72.924564z M43.070313,1.0046501C44.35677,0.99162912 45.666668,1.0059524 47,1.0476184 70.333336,1.7142854 86,8.0476189 94,20.047619L48,20.047619 1,20.047619C9.75,7.5476189,23.773438,1.1999626,43.070313,1.0046501z M59,37L38,37 M59,33L38,33" />
                                        </Animation>
                                    </RSIPath.Animations>
                                </RSIPath>

                                <Grid Visibility="{FODBinding}">
                                    <Grid x:Name="BlockValvesEnable" Visibility="{Value BlockValvesEnable}">
                                        <Path x:Name="LeftBlockValve"
                                              Data="M0,0 1,1 1,0 0,1z"
                                              Fill="{Binding CurrentColorBlockValve1, RelativeSource={RelativeSource TemplatedParent}}"
                                              Stretch="Fill"
                                              Stroke="{TemplateBinding BorderBrush}"
                                              StrokeThickness="{TemplateBinding BorderThickness}"                          
                                              Margin="-25,0,0,4"
                                              Height="15"
                                              Width="20"
                                              VerticalAlignment="Bottom"
                                              HorizontalAlignment="Left"/>
                                        <Path x:Name="RightBlockValve"
                                              Data="M0,0 1,1 1,0 0,1z"
                                              Fill="{Binding CurrentColorBlockValve2, RelativeSource={RelativeSource TemplatedParent}}"
                                              Stretch="Fill"
                                              Stroke="{TemplateBinding BorderBrush}"
                                              StrokeThickness="{TemplateBinding BorderThickness}"                         
                                              Margin="0,0,-25,4"
                                              Height="15"
                                              Width="20"
                                              VerticalAlignment="Bottom"
                                              HorizontalAlignment="Right"/>
                                    </Grid>
                                    <Grid x:Name="BypassValveEnable" Visibility="{Value BypassValveEnable}">
                                        <Path x:Name="BypassValvePipe"
                                              Data="M0,0 0,1 1,1 1,0"
                                              Stretch="Fill"
                                              Stroke="{Binding PipeColor, RelativeSource={RelativeSource TemplatedParent}}"
                                              StrokeThickness="2"                          
                                              Margin="-30,30,-30,-40"/>
                                        <Path x:Name="BypassValve"
                                              Data="M0,0 1,1 1,0 0,1z"
                                              Fill="{Binding CurrentColorBypassValve, RelativeSource={RelativeSource TemplatedParent}}"
                                              Stretch="Fill"
                                              Stroke="{TemplateBinding BorderBrush}"
                                              StrokeThickness="{TemplateBinding BorderThickness}"                          
                                              Margin="0,0,0,-46"
                                              Height="15"
                                              Width="20"
                                              VerticalAlignment="Bottom"
                                              HorizontalAlignment="Center"/>
                                    </Grid>
                                </Grid>
                            </RSIGrid>

                            <!-- ESD -->
                            <RSIBorder x:Name="ESD" BorderBrush="#FFEE1E1E" BorderThickness="2" Margin="-2">
                                <RSIBorder.Animations>
                                    <Animation Condition="$VALVEACTUATOR.ESDActive + $VALVEACTUATOR.ESDActiveHP = 0">
                                        <Invisible/>
                                    </Animation>
                                </RSIBorder.Animations>
                            </RSIBorder>

                            <!--  ESD Interlock  -->
                            <RSI_Interlock x:Name="esdGrid" 
                                               VerticalAlignment="Top" 
                                               HorizontalAlignment="Right" 
                                               Margin="0,0,-20,0" 
                                               DataContext="{Binding ValveActuator.Unit, RelativeSource={RelativeSource TemplatedParent}}"
                                               ESDLevelName="{TemplateBinding ESDLevelName}"/>

                            <!-- Failure -->
                            <Flash x:Name="Flash"
                                            Margin="-10"
                                            HorizontalAlignment="Right"
                                            FailureSource="{Binding ValveActuator.Unit, RelativeSource={RelativeSource TemplatedParent}}"
                                            VerticalAlignment="Top"
                                            Visibility="Visible"
                                            Visitor="{Binding RelativeSource={RelativeSource TemplatedParent}}" />

                        </RSIGrid>

                        <!--  TagName/Value  -->
                        <Grid x:Name="Tagname" 
                              VerticalAlignment="Bottom" 
                              HorizontalAlignment="Center" 
                              Grid.Column="1" 
                              Margin="-200,0,-200,-15">
                            <TextBlock x:Name="textTagname" 
                                       Text="{TemplateBinding TagName}"
                                       Visibility="{TAGNAMESBinding}" 
                                       TextAlignment="Center" 
                                       VerticalAlignment="Center" 
                                       HorizontalAlignment="Center" />
                            <StackPanel Orientation="Horizontal"
                                        VerticalAlignment="Center" 
                                        HorizontalAlignment="Center" 
                                        Visibility="{Binding Visibility, ElementName=textTagname, Converter={VisibilityToInverseVisibility}}" >
                                <RSIText Text="\$VALVEACTUATOR.OpeningCommand:#\"/>
                                <TextBlock Text=" %"/>
                            </StackPanel>
                        </Grid>
                    </RSIGrid>
                    <ControlTemplate.Triggers>
                        <Trigger Property="Orientation" Value="West">
                            <Setter TargetName="path" Property="RenderTransform">
                                <Setter.Value>
                                    <RotateTransform Angle="-90" />
                                </Setter.Value>
                            </Setter>
                            <Setter TargetName="Tagname" Property="HorizontalAlignment" Value="Left"/>
                            <Setter TargetName="Tagname" Property="VerticalAlignment" Value="Center"/>
                            <Setter TargetName="Tagname" Property="Margin" Value="0,0,-200,0"/>
                            <Setter TargetName="Tagname" Property="Grid.Column" Value="2"/>
                        </Trigger>
                        <Trigger Property="Orientation" Value="East">
                            <Setter TargetName="path" Property="RenderTransform">
                                <Setter.Value>
                                    <RotateTransform Angle="90" />
                                </Setter.Value>
                            </Setter>
                            <Setter TargetName="Tagname" Property="HorizontalAlignment" Value="Right"/>
                            <Setter TargetName="Tagname" Property="VerticalAlignment" Value="Center"/>
                            <Setter TargetName="Tagname" Property="Margin" Value="-200,0,0,0"/>
                            <Setter TargetName="Tagname" Property="Grid.Column" Value="0"/>
                        </Trigger>
                        <Trigger Property="Orientation" Value="South">
                            <Setter TargetName="path" Property="RenderTransform">
                                <Setter.Value>
                                    <RotateTransform Angle="180" />
                                </Setter.Value>
                            </Setter>
                            <Setter TargetName="Tagname" Property="HorizontalAlignment" Value="Center"/>
                            <Setter TargetName="Tagname" Property="VerticalAlignment" Value="Top"/>
                            <Setter TargetName="Tagname" Property="Margin" Value="-200,-20,-200,0"/>
                            <Setter TargetName="Tagname" Property="Grid.Column" Value="1"/>
                            <Setter TargetName="esdGrid" Property="VerticalAlignment" Value="Bottom"/>
                        </Trigger>
                    </ControlTemplate.Triggers>
                </ControlTemplate>
            </Setter.Value>
        </Setter>
    </Style>

    <Style x:Key="RSI_BlockValve_Esd" TargetType="{x:Type RSI_BlockValve}">
        <Setter Property="Width" Value="35"/>
        <Setter Property="Height" Value="40"/>
        <Setter Property="ColorClose" Value="White"/>
        <Setter Property="ColorOpen" Value="Black"/>
        <Setter Property="ColorTravel" Value="Black"/>
        <Setter Property="Template">
            <Setter.Value>
                <ControlTemplate TargetType="{x:Type RSI_BlockValve}">
                    <RSIGrid>
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="Auto"/>
                            <ColumnDefinition Width="*"/>
                            <ColumnDefinition Width="Auto"/>
                        </Grid.ColumnDefinitions>

                        <RSIGrid Background="{TemplateBinding Background}"
                                 Grid.Column="1">
                            <RSIGrid x:Name="path" 
                                     RenderTransformOrigin="0.5,0.5">
                                <RSIPath 
                                    Data="M22.875,33.475001 L22.875,11.833334 M43.776001,22.574902 L43.618298,44.496082 22.87738,33.49461 z M1.4714266,22.140387 L22.861666,33.486275 22.87738,33.49461 1.4320003,44.700001 z M0.5,0.5 L44.716743,0.39954545 44.700001,11.9 0.5,11.9 z"
                                    Fill="{TemplateBinding CurrentColor}"                                    
                                    Stretch="Fill"
                                    Stroke="{TemplateBinding BorderBrush}"
                                    StrokeThickness="{TemplateBinding BorderThickness}" >
                                    <RSIPath.Animations>
                                        <!-- ESDSensitive AND ESDAction = FailOpen -->
                                        <Animation
                                            Condition="$TAGNAME.ESDSensitive = true AND $TAGNAME.ESDAction = 0">
                                            <ChangePropertyValue PropertyName="Data"
                                                                 Value="M22.875,13 L18,21 27.75,21 z M22.875,33.475001 L22.80517,20.888506 M43.776001,22.574902 L43.618298,44.496082 22.87738,33.49461 z M1.4714266,22.140387 L22.861666,33.486275 22.87738,33.49461 1.4320003,44.700001 z M0.5,0.5 L44.716743,0.39954545 44.700001,11.9 0.5,11.9 z" />
                                        </Animation>
                                        <!-- ESDSensitive AND ESDAction = FailClose -->
                                        <Animation
                                            Condition="$TAGNAME.ESDSensitive = true AND $TAGNAME.ESDAction = 1">
                                            <ChangePropertyValue PropertyName="Data"
                                                                 Value="M22.875,32.63 L18,24.63 27.75,24.63 z M22.872165,24.149252 L22.872165,11.642464 M43.776001,22.574902 L43.618298,44.496082 22.87738,33.49461 z M1.4714266,22.140387 L22.861666,33.486275 22.87738,33.49461 1.4320003,44.700001 z M0.5,0.5 L44.716743,0.39954545 44.700001,11.9 0.5,11.9 z" />
                                        </Animation>
                                        <!-- ESDSensitive AND ESDAction = FailIntermediate or FailPosition -->
                                        <Animation
                                            Condition="$TAGNAME.ESDSensitive = true AND $TAGNAME.ESDAction > 1" IsContinuous="True">
                                            <ChangePropertyValue PropertyName="Data"
                                                                 Value="M22.875,32.63 L18,24.63 27.75,24.63 z M22.872165,24.149252 L22.859603,21.03953 M43.776001,22.574902 L43.618298,44.496082 22.87738,33.49461 z M1.4714266,22.140387 L22.861666,33.486275 22.87738,33.49461 1.4320003,44.700001 z M0.5,0.5 L44.716743,0.39954545 44.700001,11.9 0.5,11.9 z M22.875,13 L18,21 27.75,21 z" />
                                        </Animation>
                                    </RSIPath.Animations>
                                </RSIPath>

                                <!-- ESD -->
                                <RSIBorder x:Name="ESD" BorderBrush="#FFEE1E1E" BorderThickness="2" Margin="-2">
                                    <RSIBorder.Animations>
                                        <Animation Condition="$TAGNAME.ESDActive + $TAGNAME.ESDActiveHP = 0">
                                            <Invisible/>
                                        </Animation>
                                    </RSIBorder.Animations>
                                </RSIBorder>
                            </RSIGrid>

                            <!--  ESD Interlock  -->
                            <RSI_Interlock x:Name="esdGrid" 
                                               VerticalAlignment="Top" 
                                               HorizontalAlignment="Right" 
                                               Margin="0,0,-20,0"
                                               ESDLevelName="{TemplateBinding ESDLevelName}"/>


                            <!--  Failure -->
                            <Flash x:Name="Flash"
                                            Margin="-10"
                                            HorizontalAlignment="Right"
                                            VerticalAlignment="Top"
                                            Visibility="Visible"
                                            Visitor="{Binding RelativeSource={RelativeSource TemplatedParent}}" />

                        </RSIGrid>

                        <!--  TagName  -->
                        <TextBlock x:Name="Tagname" 
                                   Text="{TemplateBinding TagName}"
                                   Visibility="{TAGNAMESBinding}" 
                                   TextAlignment="Center" 
                                   VerticalAlignment="Bottom" 
                                   HorizontalAlignment="Center" 
                                   Grid.Column="1" 
                                   Margin="-200,0,-200,-15"/>
                    </RSIGrid>
                    <ControlTemplate.Triggers>
                        <Trigger Property="Orientation" Value="West">
                            <Setter TargetName="path" Property="RenderTransform">
                                <Setter.Value>
                                    <RotateTransform Angle="-90" />
                                </Setter.Value>
                            </Setter>
                            <Setter TargetName="Tagname" Property="HorizontalAlignment" Value="Left"/>
                            <Setter TargetName="Tagname" Property="VerticalAlignment" Value="Center"/>
                            <Setter TargetName="Tagname" Property="Margin" Value="0,0,-200,0"/>
                            <Setter TargetName="Tagname" Property="Grid.Column" Value="2"/>
                        </Trigger>
                        <Trigger Property="Orientation" Value="East">
                            <Setter TargetName="path" Property="RenderTransform">
                                <Setter.Value>
                                    <RotateTransform Angle="90" />
                                </Setter.Value>
                            </Setter>
                            <Setter TargetName="Tagname" Property="HorizontalAlignment" Value="Right"/>
                            <Setter TargetName="Tagname" Property="VerticalAlignment" Value="Center"/>
                            <Setter TargetName="Tagname" Property="Margin" Value="-200,0,0,0"/>
                            <Setter TargetName="Tagname" Property="Grid.Column" Value="0"/>
                        </Trigger>
                        <Trigger Property="Orientation" Value="South">
                            <Setter TargetName="path" Property="RenderTransform">
                                <Setter.Value>
                                    <RotateTransform Angle="180" />
                                </Setter.Value>
                            </Setter>
                            <Setter TargetName="Tagname" Property="HorizontalAlignment" Value="Center"/>
                            <Setter TargetName="Tagname" Property="VerticalAlignment" Value="Top"/>
                            <Setter TargetName="Tagname" Property="Margin" Value="-200,-20,-200,0"/>
                            <Setter TargetName="Tagname" Property="Grid.Column" Value="1"/>
                            <Setter TargetName="esdGrid" Property="VerticalAlignment" Value="Bottom"/>
                        </Trigger>
                    </ControlTemplate.Triggers>
                </ControlTemplate>
            </Setter.Value>
        </Setter>
    </Style>


    <Style x:Key="RSI_Static_Elbow3D" TargetType="{x:Type RSI_StaticControl}">
        <Setter Property="Width" Value="10"/>
        <Setter Property="Height" Value="10"/>
        <Setter Property="Background" Value="Black"/>
        <Setter Property="Template">
            <Setter.Value>
                <ControlTemplate TargetType="{x:Type RSI_StaticControl}">
                    <Grid>
                        <Path Data="M10,5 C7.3,5 5,7.3 5,10 5,10 0,10 0,10 0,5 4,0 10,0 z"
                              Fill="{TemplateBinding Background}"
                              Stretch="Fill"/>
                        <Path Data="M10,5 C7.3,5 5,7.3 5,10 5,10 0,10 0,10 0,5 4,0 10,0 z"
                              Stretch="Fill">
                            <Path.Fill>
                                <RadialGradientBrush Center="1,1" GradientOrigin="1.1,1.1" RadiusX="1" RadiusY="1">
                                    <GradientStop Color="Transparent" Offset="0.546"/>
                                    <GradientStop Color="White" Offset="0.7575"/>
                                    <GradientStop Color="Transparent" Offset="1"/>
                                </RadialGradientBrush>
                            </Path.Fill>
                        </Path>
                    </Grid>
                </ControlTemplate>
            </Setter.Value>
        </Setter>
    </Style>

    <Style x:Key="RSI_Static_Elbow" TargetType="{x:Type RSI_StaticControl}">
        <Setter Property="Width" Value="10"/>
        <Setter Property="Height" Value="10"/>
        <Setter Property="Background" Value="Black"/>
        <Setter Property="Template">
            <Setter.Value>
                <ControlTemplate TargetType="{x:Type RSI_StaticControl}">
                    <Path Data="M10,5 C7.3,5 5,7.3 5,10 5,10 0,10 0,10 0,5 4,0 10,0 z"
                              Fill="{TemplateBinding Background}"
                              Stretch="Fill"/>
                </ControlTemplate>
            </Setter.Value>
        </Setter>
    </Style>

    <Style x:Key="RSI_Static_Pipe" TargetType="{x:Type RSI_StaticControl}">
        <Setter Property="Width" Value="10"/>
        <Setter Property="Height" Value="10"/>
        <Setter Property="Background" Value="Black"/>
        <Setter Property="Template">
            <Setter.Value>
                <ControlTemplate TargetType="{x:Type RSI_StaticControl}">
                    <Path Data="M10,5 C7.3,5 5,7.3 5,10 5,10 0,10 0,10 0,5 4,0 10,0 z"
                          Fill="{TemplateBinding Background}"
                          Stretch="Fill"/>
                </ControlTemplate>
            </Setter.Value>
        </Setter>
    </Style>


</ResourceDictionary>